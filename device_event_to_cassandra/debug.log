Data recieved from spark code to write in console: 
+-----------+------+-------------------+-------------------+---------------+-------------------+-------------------+-----+
|device     |event |firstOccurrenceTime|lastOccurrenceTime |occurrenceCount|receiveTime        |persistTime        |state|
+-----------+------+-------------------+-------------------+---------------+-------------------+-------------------+-----+
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 17:31:37|1              |2023-02-03 17:31:37|2023-02-03 17:31:33|open |
|ALL8001146 |501740|2023-01-20 18:27:54|2023-02-03 17:58:11|16             |2023-02-03 17:58:11|2023-02-03 17:58:14|open |
|ALL8001146 |501740|2023-01-20 18:27:54|2023-02-03 17:59:11|17             |2023-02-03 17:59:11|2023-02-03 17:59:13|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 18:01:51|2              |2023-02-03 18:01:51|2023-02-03 18:01:47|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 18:03:01|3              |2023-02-03 18:03:01|2023-02-03 18:02:57|open |
|JPM10050331|406006|2023-02-03 18:03:08|2023-02-03 18:03:08|1              |2023-02-03 18:03:08|2023-02-03 18:03:07|open |
|JPM10050329|501710|2023-02-03 18:02:03|2023-02-03 18:02:03|1              |2023-02-03 18:02:03|2023-02-03 18:08:57|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 18:25:46|4              |2023-02-03 18:25:46|2023-02-03 18:26:45|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 18:29:38|5              |2023-02-03 18:29:38|2023-02-03 18:29:34|open |
|JPM10050331|406006|2023-02-03 18:03:08|2023-02-03 18:30:06|2              |2023-02-03 18:30:06|2023-02-03 18:30:06|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 18:31:07|6              |2023-02-03 18:31:07|2023-02-03 18:31:06|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 18:34:36|7              |2023-02-03 18:34:36|2023-02-03 18:34:32|open |
|JPM10050329|501710|2023-02-03 18:02:03|2023-02-03 18:29:49|2              |2023-02-03 18:29:49|2023-02-03 18:39:00|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 18:47:19|8              |2023-02-03 18:47:19|2023-02-03 18:47:15|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 19:12:06|9              |2023-02-03 19:12:06|2023-02-03 19:12:05|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-03 19:59:11|10             |2023-02-03 19:59:11|2023-02-03 19:59:07|open |
|JPM10050321|402247|2023-02-03 18:44:43|2023-02-03 18:44:43|1              |2023-02-03 18:44:43|2023-02-04 02:11:44|open |
|JPM10050321|402247|2023-02-03 18:44:43|2023-02-03 19:13:39|2              |2023-02-03 19:13:39|2023-02-04 02:11:57|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-04 12:52:00|11             |2023-02-04 12:52:00|2023-02-04 12:51:55|open |
|JPM10050296|409012|2023-02-03 17:31:37|2023-02-04 14:47:54|12             |2023-02-04 14:47:54|2023-02-04 14:47:50|open |
+-----------+------+-------------------+-------------------+---------------+-------------------+-------------------+-----+

Conclusion: Kafka to Spark connection is OK

Let's try to manually insert data into the cassandra table to check if data format is compatible:
INSERT INTO poc.device_event (device, event, firstOccurrenceTime, lastOccurrenceTime, occurrenceCount, receiveTime, persistTime, state) VALUES 
('JPM10050296', 409012, '2023-02-03 17:31:37', '2023-02-03 17:31:37', 1, '2023-02-03 17:31:37', '2023-02-03 17:31:33', 'open');


Result:
Insert Successful!
cassandra@cqlsh> INSERT INTO poc.device_event (device, event, firstOccurrenceTime, lastOccurrenceTime, occurrenceCount, receiveTime, persistTime, state) VALUES 
   ... ('JPM10050296', 409012, '2023-02-03 17:31:37', '2023-02-03 17:31:37', 1, '2023-02-03 17:31:37', '2023-02-03 17:31:33', 'open');
cassandra@cqlsh> select * from poc.device_event ;

 device      | event  | receivetime                     | firstoccurrencetime             | lastoccurrencetime              | occurrencecount | persisttime                     | state
-------------+--------+---------------------------------+---------------------------------+---------------------------------+-----------------+---------------------------------+-------
 JPM10050296 | 409012 | 2023-02-03 17:31:37.000000+0000 | 2023-02-03 17:31:37.000000+0000 | 2023-02-03 17:31:37.000000+0000 |               1 | 2023-02-03 17:31:33.000000+0000 |  open


Now lets try to make a few changes in the pyspark code to make it work!!!!

------------------------------------------------------------------------------